/*
 * jQuery Storage API Plugin
 *
 * Copyright (c) 2013 Julien Maurel
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/mit-license.php
 *
 * Project home:
 * https://github.com/julien-maurel/jQuery-Storage-API
 *
 * Version: 1.6.0
 *
 */(function(e){function i(t){var n=arguments.length,r=window[t],i=arguments,s=i[1],o,u,a;if(n<2)throw new Error("Minimum 2 arguments must be given");if(e.isArray(s)){u={};for(var f in s){o=s[f];try{u[o]=JSON.parse(r.getItem(o))}catch(l){u[o]=r.getItem(o)}}return u}if(n!=2){try{u=JSON.parse(r.getItem(s))}catch(l){throw new ReferenceError(s+" is not defined in this storage")}for(var f=2;f<n-1;f++){u=u[i[f]];if(u===undefined)throw new ReferenceError([].slice.call(i,1,f+1).join(".")+" is not defined in this storage")}if(e.isArray(i[f])){a=u;u={};for(var c in i[f])u[i[f][c]]=a[i[f][c]];return u}return u[i[f]]}try{return JSON.parse(r.getItem(s))}catch(l){return r.getItem(s)}}function s(t){var n=arguments.length,r=window[t],i=arguments,s=i[1],o=i[2],u,a={},f;if(n<2||!e.isPlainObject(s)&&n<3)throw new Error("Minimum 3 arguments must be given or second parameter must be an object");if(e.isPlainObject(s)){for(var l in s){u=s[l];e.isPlainObject(u)?r.setItem(l,JSON.stringify(u)):r.setItem(l,u)}return s}if(n==3){typeof o=="object"?r.setItem(s,JSON.stringify(o)):r.setItem(s,o);return o}try{f=r.getItem(s);f!=null&&(a=JSON.parse(f))}catch(c){}f=a;for(var l=2;l<n-2;l++){u=i[l];if(!f[u]||!e.isPlainObject(f[u]))f[u]={};f=f[u]}f[i[l]]=i[l+1];r.setItem(s,JSON.stringify(a));return a}function o(t){var n=arguments.length,r=window[t],i=arguments,s=i[1],o,u;if(n<2)throw new Error("Minimum 2 arguments must be given");if(e.isArray(s)){for(var a in s)r.removeItem(s[a]);return!0}if(n==2){r.removeItem(s);return!0}try{o=u=JSON.parse(r.getItem(s))}catch(f){throw new ReferenceError(s+" is not defined in this storage")}for(var a=2;a<n-1;a++){u=u[i[a]];if(u===undefined)throw new ReferenceError([].slice.call(i,1,a).join(".")+" is not defined in this storage")}if(e.isArray(i[a]))for(var l in i[a])delete u[i[a][l]];else delete u[i[a]];r.setItem(s,JSON.stringify(o));return!0}function u(t,n){var r=l(t);for(var i in r)o(t,r[i]);if(n)for(var i in e.namespaceStorages)c(i)}function a(t){var n=arguments.length,r=arguments,s=window[t],o=r[1];if(n==1)return l(t).length==0;if(e.isArray(o)){for(var u=0;u<o.length;u++)if(!a(t,o[u]))return!1;return!0}try{var f=i.apply(this,arguments);e.isArray(r[n-1])||(f={totest:f});for(var u in f)if(!(e.isPlainObject(f[u])&&e.isEmptyObject(f[u])||e.isArray(f[u])&&!f[u].length||!f[u]))return!1;return!0}catch(c){return!0}}function f(t){var n=arguments.length,r=arguments,s=window[t],o=r[1];if(n<2)throw new Error("Minimum 2 arguments must be given");if(e.isArray(o)){for(var u=0;u<o.length;u++)if(!f(t,o[u]))return!1;return!0}try{var a=i.apply(this,arguments);e.isArray(r[n-1])||(a={totest:a});for(var u in a)if(a[u]===undefined||a[u]===null)return!1;return!0}catch(l){return!1}}function l(t){var n=arguments.length,r=window[t],s=arguments,o=s[1],u=[],a={};n>1?a=i.apply(this,s):a=r;if(a._cookie)for(var f in e.cookie())f!=""&&u.push(f.replace(a._prefix,""));else for(var l in a)u.push(l);return u}function c(t){if(!t||typeof t!="string")throw new Error("First parameter must be a string");window.localStorage.getItem(t)||window.localStorage.setItem(t,"{}");window.sessionStorage.getItem(t)||window.sessionStorage.setItem(t,"{}");var n={localStorage:e.extend({},e.localStorage,{_ns:t}),sessionStorage:e.extend({},e.sessionStorage,{_ns:t})};if(e.cookie){window.cookieStorage.getItem(t)||window.cookieStorage.setItem(t,"{}");n.cookieStorage=e.extend({},e.cookieStorage,{_ns:t})}e.namespaceStorages[t]=n;return n}var t="ls_",n="ss_",h={_type:"",_ns:"",_callMethod:function(e,t){var n=[this._type];this._ns&&n.push(this._ns);[].push.apply(n,t);return e.apply(this,n)},get:function(){return this._callMethod(i,arguments)},set:function(){var t=arguments.length,n=arguments,i=n[0];if(t<1||!e.isPlainObject(i)&&t<2)throw new Error("Minimum 2 arguments must be given or first parameter must be an object");if(e.isPlainObject(i)&&this._ns){for(var o in i)s(this._type,this._ns,o,i[o]);return i}r=this._callMethod(s,n);return this._ns?r[i]:r},remove:function(){if(arguments.length<1)throw new Error("Minimum 1 argument must be given");return this._callMethod(o,arguments)},removeAll:function(e){if(this._ns){s(this._type,this._ns,{});return!0}return u(this._type,e)},isEmpty:function(){return this._callMethod(a,arguments)},isSet:function(){if(arguments.length<1)throw new Error("Minimum 1 argument must be given");return this._callMethod(f,arguments)},keys:function(){return this._callMethod(l,arguments)}};if(e.cookie){window.name||(window.name=Math.floor(Math.random()*1e8));var p={_cookie:!0,_prefix:"",_expires:null,_path:null,_domain:null,setItem:function(t,n){e.cookie(this._prefix+t,n,{expires:this._expires,path:this._path,domain:this._domain})},getItem:function(t){return e.cookie(this._prefix+t)},removeItem:function(t){return e.removeCookie(this._prefix+t)},clear:function(){for(var r in e.cookie())r!=""&&(!this._prefix&&r.indexOf(t)===-1&&r.indexOf(n)===-1||this._prefix&&r.indexOf(this._prefix)===0)&&e.removeCookie(r)},setExpires:function(e){this._expires=e;return this},setPath:function(e){this._path=e;return this},setDomain:function(e){this._domain=e;return this},setConf:function(e){e.path&&(this._path=e.path);e.domain&&(this._domain=e.domain);e.expires&&(this._expires=e.expires);return this},setDefaultConf:function(){this._path=this._domain=this._expires=null}};if(!window.localStorage){window.localStorage=e.extend({},p,{_prefix:t,_expires:3650});window.sessionStorage=e.extend({},p,{_prefix:n+window.name+"_"})}window.cookieStorage=e.extend({},p);e.cookieStorage=e.extend({},h,{_type:"cookieStorage",setExpires:function(e){window.cookieStorage.setExpires(e);return this},setPath:function(e){window.cookieStorage.setPath(e);return this},setDomain:function(e){window.cookieStorage.setDomain(e);return this},setConf:function(e){window.cookieStorage.setConf(e);return this},setDefaultConf:function(){window.cookieStorage.setDefaultConf();return this}})}e.initNamespaceStorage=function(e){return c(e)};e.localStorage=e.extend({},h,{_type:"localStorage"});e.sessionStorage=e.extend({},h,{_type:"sessionStorage"});e.namespaceStorages={};e.removeAllStorages=function(t){e.localStorage.removeAll(t);e.sessionStorage.removeAll(t);e.cookieStorage&&e.cookieStorage.removeAll(t);t||(e.namespaceStorages={})}})(jQuery);